---
import '../index.css';
import logoWhite from '../assets/images/logo-white.png';
import Footer from '../components/Footer.astro';
import YouTubeVideo from '../components/YouTubeVideo.astro';
import ShortsCarouselSvelte from '../components/ShortsCarousel.svelte';
import SocialLinks from '../components/SocialLinks.astro';
import {getLatestVideosFromChannel} from '../utils/youtube';

const channelId = import.meta.env.YOUTUBE_CHANNEL_ID;
const allVideos = await getLatestVideosFromChannel(channelId, 20);

const shorts = allVideos.filter((video) => video.isShort);
const regularVideos = allVideos.filter((video) => !video.isShort);
---

<html lang='en'>
  <head>
    <meta charset='utf-8' />
    <link
      rel='icon'
      href='data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üö¥‚Äç‚ôÇÔ∏è</text></svg>'
    />
    <meta name='viewport' content='width=device-width' />

    <meta name='generator' content={Astro.generator} />
    <title>ridetime | Chod≈∫ na rower</title>
    <meta name='description' content='Rowery, ubrania, sprzƒôt i trasy - dla fan√≥w kolarstwa.' />
  </head>
  <body class='bg-ridetime-dark'>
    <div class='mx-auto max-w-5xl p-4 space-y-8'>
      <div class='flex flex-col gap-y-4 sm:gap-y-0 sm:flex-row items-center justify-between'>
        <img src={logoWhite.src} alt='ridetime logo' class='h-16' />
        <SocialLinks showLabels={true} />
      </div>

      <!-- Embed ShortsCarouselSvelte component directly -->
      <div class='mb-8'>
        <h2 class='text-2xl font-bold mb-4 text-sky-200'>Shorts</h2>
        <ShortsCarouselSvelte client:load shorts={shorts} />
      </div>

      <!-- Regular videos list -->
      <h2 class='text-2xl font-bold mb-4 text-sky-200'>Najnowsze filmy</h2>
      <ul class='space-y-16'>
        {regularVideos.map((video) => <li>{video.id && <YouTubeVideo videoId={video.id} />}</li>)}
      </ul>

      <Footer />
    </div>
  </body>
</html>
